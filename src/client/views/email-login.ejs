<!DOCTYPE html>
<html>

<head>

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Email - Login</title>
    <link rel="stylesheet" href="../css/reset.css">
    <link rel="stylesheet" href="../css/theme.css">
    <link rel="stylesheet" href="../css/stylesheet.css">
    <link rel="stylesheet" href="../css/signin.css">
    <script src="https://kit.fontawesome.com/c08742ea51.js" crossorigin="anonymous"></script>
    <script src='https://kit.fontawesome.com/a076d05399.js'></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
</head>

<body>

    <header>
        <%- include ('partials/header.ejs') %>
    </header>
    <section id="full">


        <% if(error) {%>
            <% if(errorType==='Success' ) { %>
                <div class="error_container error_container--success">
                    <div class="col--1">
                        <div class="error_container__icon">
                            <i class="fas fa-check-circle"></i>
                        </div>
                    </div>
                    <div class="col--2">
                        <div class="error_container__title heading-3">
                            Success
                        </div>
                        <span class="para-1 error" id="cancelLogin">
                            <%= error %>
                                <!-- Valid Only for 60 Seconds. -->
                        </span>
                    </div>
                    <div class="col--3">
                        <div class="error_container__icon" id="cross">
                            <i class="fas fa-times"></i>
                        </div>
                    </div>
                </div>
                <% } %>
                    <% if(errorType==='Failure' ) { %>
                        <div class="error_container">
                            <div class="col--1">
                                <div class="error_container__icon">
                                    <i class="fas fa-times-circle"></i>
                                </div>
                            </div>
                            <div class="col--2">
                                <div class="error_container__title heading-3">
                                    Failure
                                </div>
                                <span class="para-1 error" id="cancelLogin">
                                    <%= error %>
                                        <!-- Valid Only for 60 Seconds. -->
                                </span>
                            </div>
                            <div class="col--3">
                                <div class="error_container__icon" id="cross">
                                    <i class="fas fa-times"></i>
                                </div>
                            </div>
                        </div>
                        <% } %>
                            <% if(errorType==='Info' ) { %>
                                <div class="error_container error_container--info">
                                    <div class="col--1">
                                        <div class="error_container__icon">
                                            <i class="fas fa-info-circle"></i>
                                        </div>
                                    </div>
                                    <div class="col--2">
                                        <div class="error_container__title heading-3">
                                            Info
                                        </div>
                                        <span class="para-1 error" id="cancelLogin">
                                            <%= error %>
                                                <!-- Valid Only for 60 Seconds. -->
                                        </span>
                                    </div>
                                    <div class="col--3">
                                        <div class="error_container__icon" id="cross">
                                            <i class="fas fa-times"></i>
                                        </div>
                                    </div>
                                </div>
                                <% } %>
                                    <% } %>

                                        <div class="formcont">
                                            <h1>Email Login</h1>
                                            <hr>
                                            <form class="signinform" action="email-login" method="POST">
                                                <!-- <i class="fas fa-question-circle"></i> -->
                                                <input id="email" name="email" type="email"
                                                    placeholder=" Enter Your Email" required>
                                                <!-- <input id="otp" type="text" placeholder="Enter OTP"> -->
                                                <div class="pass_eye">
                                                    <input type="password" name="password" id="password"
                                                    placeholder="Enter Password"
                                                    pattern="(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{8,}"
                                                    title="Must contain at least one number and one uppercase and lowercase letter, and at least 8 or more characters"
                                                    required>
                                                <i class="far fa-eye" id="togglePassword"></i>
                                            </div>
                                                <div class="forgot_password">
                                                    <a href="/phone-login"> Login with OTP</a>
                                                    <a id="forgotPassword">Forgot Password?</a>
                                                </div>
                                                <div class="sbmt">
                                                <button class="darkbluebtn btn" id="login" type="submit">LOGIN</button>
                                                <i class='fas fa-arrow-right arrow'></i>
                                                </div>
                                            </form>
                                            <h5>Not registered? <a href="/signup">Sign Up</a></h5>
                                        </div>
    </section>
    <section class="foooter">
        <h6>All Rights Reserved. &#169 tvastra 2021</h6>
    </section>


    <script src="../js files/togglepassword.js"></script>
    <script src="../js files/forgotPassword.js">
        const forgotPasswordBtn = document.querySelector('#forgotPassword');

        const forgotPassword = async () => {
            const emailAddress = document.querySelector('input[name="email"]').value;
            const response = await fetch('/forgot-password', {
                method: 'post',
                headers: {
                    "Content-Type": "application/json"
                },
                body: JSON.stringify({ email: emailAddress }),
            });
            window.location.replace(response.url);
        }

        forgotPasswordBtn.addEventListener('click', forgotPassword);
    </script>
    <script type="text/javascript" src="index.js"></script>
    <script>
        const error = document.querySelector('.error_container');
        const cross = document.querySelector('.col--3');
        const hideError = () => {
            error.style.display = 'none';
            fetch('/disable-error', {
                method: 'put'
            });
        }

        if (error) {
            fetch('/disable-error', {
                method: 'put'
            });
            setTimeout(() => {
                error.style.display = 'none';
            }, 5000);
        }

        cross.addEventListener('click', hideError);

    </script>
    <script src="../js files/index.js"></script>
</body>

</html>